(function(){let n=[];const a=window.CHATBOT_API_URL,t=document.getElementById("chatbot-toggle"),s=document.getElementById("chatbot-container"),r=document.getElementById("chatbot-close"),c=document.getElementById("chatbot-form"),e=document.getElementById("chatbot-input"),o=document.getElementById("chatbot-messages");if(!t||!s)return;t.addEventListener("click",function(){s.classList.remove("chatbot-hidden"),t.classList.add("chatbot-hidden"),e.focus()}),r.addEventListener("click",function(){s.classList.add("chatbot-hidden"),t.classList.remove("chatbot-hidden")}),c.addEventListener("submit",async function(t){t.preventDefault();const o=e.value.trim();if(!o)return;i(o,"user"),e.value="",e.disabled=!0;const s=i("...","bot");try{n.push({role:"user",content:o});const t=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:n})}),e=await t.json();t.ok&&e&&e[0]&&e[0].text?(s.textContent=e[0].text,n.push({role:"assistant",content:e[0].text})):e.error?s.textContent="Sorry, "+e.error.toLowerCase():s.textContent=t.ok?"Sorry, I couldn't understand the response.":"Sorry, something went wrong."}catch{s.textContent="Sorry, something went wrong. Please try again."}e.disabled=!1,e.focus()});function i(e,t){const n=document.createElement("div");return n.className="chatbot-message chatbot-"+t,n.textContent=e,o.appendChild(n),o.scrollTop=o.scrollHeight,n}})()